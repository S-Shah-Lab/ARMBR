<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="License" href="license.html" /><link rel="prev" title="Modules" href="modules.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>ARMBR API - ARMBR Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ARMBR Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">ARMBR Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">ARMBR API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/armbr.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="armbr-api">
<h1>ARMBR API<a class="headerlink" href="#armbr-api" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="armbr.ARMBR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">armbr.</span></span><span class="sig-name descname"><span class="pre">ARMBR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MNE-compatible wrapper for ARMBR, a blink artifact removal algorithm for EEG.</p>
<p>ARMBR identifies and suppresses blink artifacts using multivariate backward
regression. It leverages a binarized blink reference signal to estimate and
project out blink-related spatial components. The method requires only a small
amount of training data and works without requiring ICA or dedicated EOG
channels. It is especially suitable for real-time and online BCI scenarios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch_name</strong> (<em>list</em><em> of </em><em>str</em><em> | </em><em>list</em><em> of </em><em>int</em><em> | </em><em>None</em>) – Names or indices of EEG channels highly affected by blinks (e.g. Fp1, Fp2).
These are used to construct the blink reference signal. If None, defaults to [].</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em> | </em><em>'auto'</em>) – Blink detection threshold factor. If ‘auto’, ARMBR selects the threshold
automatically using method described in Section 4. Threshold selection (see Alkhoury et al., 2025).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>L. Alkhoury et al. (2025), Journal of Neural Engineering, 22(3), 036048.
<a class="reference external" href="https://doi.org/10.1088/1741-2552/ade566">https://doi.org/10.1088/1741-2552/ade566</a></p>
<p>Initialize ARMBR with optional blink channel specification and threshold strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch_name</strong> (<em>list</em><em> of </em><em>str</em><em> | </em><em>list</em><em> of </em><em>int</em><em> | </em><em>None</em>) – Names or indices of EEG channels expected to show prominent blink activity.
Common choices include Fp1, Fp2, or frontal channels near the eyes.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em> | </em><em>'auto'</em>) – Blink detection threshold multiplier. If ‘auto’, the optimal threshold
is selected automatically by maximizing the low-frequency-to-high-frequency
energy ratio in the extracted blink component.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The user-specified channels should capture prominent blink deflections.
No EOG channels are required.</p>
<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ch_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize ARMBR with optional blink channel specification and threshold strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ch_name</strong> (<em>list</em><em> of </em><em>str</em><em> | </em><em>list</em><em> of </em><em>int</em><em> | </em><em>None</em>) – Names or indices of EEG channels expected to show prominent blink activity.
Common choices include Fp1, Fp2, or frontal channels near the eyes.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em> | </em><em>'auto'</em>) – Blink detection threshold multiplier. If ‘auto’, the optimal threshold
is selected automatically by maximizing the low-frequency-to-high-frequency
energy ratio in the extracted blink component.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The user-specified channels should capture prominent blink deflections.
No EOG channels are required.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">picks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eeg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.apply" title="Link to this definition">¶</a></dt>
<dd><p>Apply ARMBR blink removal to raw EEG data.</p>
<p>This method removes blink artifacts from the specified channels using
the spatial projection matrix estimated during <cite>.fit()</cite>. The projection
is applied directly to the data via MNE’s <cite>apply_function</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raw</strong> (<em>instance</em><em> of </em><em>mne.io.BaseRaw</em>) – The raw data to clean.</p></li>
<li><p><strong>picks</strong> (<em>str</em><em> | </em><em>list</em><em> | </em><em>None</em>) – Channel picks to apply ARMBR to. Defaults to ‘eeg’.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> | </em><em>str</em><em> | </em><em>int</em><em> | </em><em>None</em>) – Control verbosity of the logging output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns the current instance with ARMBR applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>instance of <a class="reference internal" href="#armbr.ARMBR" title="armbr.ARMBR">ARMBR</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>.fit()</cite> has not been called before this method.</p></li>
<li><p><strong>ValueError</strong> – If the raw object is not preloaded (since in-place editing is required).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This modifies the input <cite>raw</cite> object in-place. To preserve the original,
use <cite>.copy()</cite> before calling <cite>.apply()</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="armbr.ARMBR.bibtex">
<span class="sig-name descname"><span class="pre">bibtex</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n\t\t&#64;article{alkhoury2025_armbr,\n\t\t\ttitle={Artifact-reference</span> <span class="pre">multivariate</span> <span class="pre">backward</span> <span class="pre">regression</span> <span class="pre">(ARMBR):</span> <span class="pre">a</span> <span class="pre">novel</span> <span class="pre">method</span> <span class="pre">for</span> <span class="pre">EEG</span> <span class="pre">blink</span> <span class="pre">artifact</span> <span class="pre">removal</span> <span class="pre">with</span> <span class="pre">minimal</span> <span class="pre">data</span> <span class="pre">requirements},\n\t\t\tauthor={Alkhoury,</span> <span class="pre">Ludvik</span> <span class="pre">and</span> <span class="pre">Scanavini,</span> <span class="pre">G</span> <span class="pre">and</span> <span class="pre">Louviot,</span> <span class="pre">S</span> <span class="pre">and</span> <span class="pre">Radanovic,</span> <span class="pre">A</span> <span class="pre">and</span> <span class="pre">Shah,</span> <span class="pre">SA</span> <span class="pre">and</span> <span class="pre">Hill,</span> <span class="pre">NJ},\n\t\t\tjournal={Journal</span> <span class="pre">of</span> <span class="pre">Neural</span> <span class="pre">Engineering},\n\t\t\tvolume={22},\n\t\t\tnumber={3},\n\t\t\tpages={036048},\n\t\t\tyear={2025},\n\t\t\tdoi={10.1088/1741-2552/ade566}\n\t\t}\n\t'</span></em><a class="headerlink" href="#armbr.ARMBR.bibtex" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.copy" title="Link to this definition">¶</a></dt>
<dd><p>Create a deep copy of the ARMBR instance.</p>
<p>This is useful for preserving the current model state before applying
changes such as refitting or reapplying to different data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inst</strong> – A deep copy of the current object, including all internal state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of <a class="reference internal" href="#armbr.ARMBR" title="armbr.ARMBR">ARMBR</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The copied instance is independent of the original and can be modified
or reapplied without affecting the original.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">picks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eeg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit the ARMBR model using raw EEG data.</p>
<p>This method prepares the data for blink artifact removal by identifying
clean EEG segments, extracting the relevant samples, and computing the
ARMBR spatial projection. Training can use either manually specified
time ranges, annotated segments labeled “armbr_fit”, or all non-rejected
data (excluding ‘<a href="#id1"><span class="problematic" id="id2">BAD_</span></a>’ annotations).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raw</strong> (<em>instance</em><em> of </em><em>mne.io.BaseRaw</em>) – Continuous raw EEG recording.</p></li>
<li><p><strong>picks</strong> (<em>str</em><em> | </em><em>list</em><em> | </em><em>slice</em><em> | </em><em>None</em>) – Channels to include. Defaults to ‘eeg’. Can be a string like ‘eeg’,
a list of channel names, or indices.</p></li>
<li><p><strong>start</strong> (<em>float</em><em> | </em><em>None</em>) – Start time in seconds for fitting. If provided, overrides annotations
and uses this exact time range.</p></li>
<li><p><strong>stop</strong> (<em>float</em><em> | </em><em>None</em>) – Stop time in seconds for fitting. If provided with <cite>start</cite>, overrides
annotations and uses this exact time range.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> | </em><em>str</em><em> | </em><em>int</em><em> | </em><em>None</em>) – Controls verbosity of the log output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted instance, with spatial weights and state stored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>instance of <a class="reference internal" href="#armbr.ARMBR" title="armbr.ARMBR">ARMBR</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If ‘armbr_fit’ annotations are present, those segments are prioritized.
Otherwise, all data not marked by ‘<a href="#id3"><span class="problematic" id="id4">BAD_</span></a>’ annotations is used. If both
<cite>start</cite> and <cite>stop</cite> are provided, these override annotations entirely.
The model must be fitted before calling <cite>.apply()</cite> or <cite>.plot()</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot EEG signals before and after ARMBR cleaning.</p>
<p>This diagnostic plot shows side-by-side traces of the original and
ARMBR-cleaned EEG data from the training set. It helps visually assess
the effectiveness of the blink suppression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> (<em>bool</em>) – Whether to display the figure immediately (default: True).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> | </em><em>str</em><em> | </em><em>int</em><em> | </em><em>None</em>) – Control verbosity of the logging output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self</strong> (<em>instance of ARMBR</em>) – Returns the current instance for chaining.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – Matplotlib figure containing the before/after subplots.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If <cite>.fit()</cite> has not been called before this method.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Red traces indicate raw EEG. Black traces show cleaned data.
Each channel is vertically offset for readability.
This plot only shows data used during training (<cite>fit()</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armbr.ARMBR.plot_blink_patterns">
<span class="sig-name descname"><span class="pre">plot_blink_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#ARMBR.plot_blink_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.ARMBR.plot_blink_patterns" title="Link to this definition">¶</a></dt>
<dd><p>Visualize the spatial blink components estimated by ARMBR.</p>
<p>This method generates topographic plots of each component in the
blink spatial pattern matrix, which represent how blinks manifest
across the EEG scalp sensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>show</strong> (<em>bool</em>) – If True, the plot is displayed immediately. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self</strong> (<em>instance of ARMBR</em>) – Returns the current instance for chaining.</p></li>
<li><p><strong>plt</strong> (<em>module</em>) – The matplotlib.pyplot module with the figure and axes created.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses <cite>mne.viz.plot_topomap</cite> to display scalp maps for
each spatial component. The colormap is centered at zero and scaled
symmetrically based on the maximum absolute pattern value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armbr.run_armbr">
<span class="sig-prename descclassname"><span class="pre">armbr.</span></span><span class="sig-name descname"><span class="pre">run_armbr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blink_ch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/armbr/armbr.html#run_armbr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armbr.run_armbr" title="Link to this definition">¶</a></dt>
<dd><p>Run ARMBR blink artifact removal on multichannel EEG data.</p>
<p>This function implements the full ARMBR algorithm pipeline on continuous EEG
data. It identifies blink artifacts from frontal EEG channels, extracts a
low-rank blink component, estimates its spatial distribution, and subtracts
it from the signal using multivariate backward regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_channels</em><em>)</em>) – Input EEG data. Each row is a time sample; each column is a channel.</p></li>
<li><p><strong>blink_ch_idx</strong> (<em>list</em><em> of </em><em>int</em>) – Indices of channels strongly affected by blinks (e.g. Fp1, Fp2).</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling frequency in Hz.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Threshold multiplier for blink detection. If set to -1, the algorithm
performs automatic optimization based on the energy ratio of low- to
high-frequency components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_clean</strong> (<em>ndarray, shape (n_samples, n_channels)</em>) – EEG data with blink artifacts removed.</p></li>
<li><p><strong>best_alpha</strong> (<em>float or None</em>) – The optimal alpha value used. If alpha was set manually, this matches
the input; if optimized, it is the best value found.</p></li>
<li><p><strong>ref_mask</strong> (<em>ndarray, shape (n_samples,)</em>) – Binary mask marking detected blink events.</p></li>
<li><p><strong>blink_comp</strong> (<em>ndarray, shape (n_samples,)</em>) – Time course of the extracted blink component.</p></li>
<li><p><strong>blink_pattern</strong> (<em>ndarray, shape (n_channels,)</em>) – Estimated spatial topography of the blink.</p></li>
<li><p><strong>blink_projection_matrix</strong> (<em>ndarray, shape (n_channels, n_channels)</em>) – Spatial projection matrix used to remove blink activity.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When <cite>alpha=-1</cite>, the algorithm sweeps a range of values to maximize the
low-frequency to high-frequency energy ratio of the blink component, as
described in Alkhoury et al. (2025). The returned <cite>blink_projection_matrix</cite>
can be applied to other EEG data for online or batch blink suppression.</p>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="license.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">License</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modules.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modules</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ARMBR API</a><ul>
<li><a class="reference internal" href="#armbr.ARMBR"><code class="docutils literal notranslate"><span class="pre">ARMBR</span></code></a><ul>
<li><a class="reference internal" href="#armbr.ARMBR.__init__"><code class="docutils literal notranslate"><span class="pre">ARMBR.__init__()</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.apply"><code class="docutils literal notranslate"><span class="pre">ARMBR.apply()</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.bibtex"><code class="docutils literal notranslate"><span class="pre">ARMBR.bibtex</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.copy"><code class="docutils literal notranslate"><span class="pre">ARMBR.copy()</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.fit"><code class="docutils literal notranslate"><span class="pre">ARMBR.fit()</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.plot"><code class="docutils literal notranslate"><span class="pre">ARMBR.plot()</span></code></a></li>
<li><a class="reference internal" href="#armbr.ARMBR.plot_blink_patterns"><code class="docutils literal notranslate"><span class="pre">ARMBR.plot_blink_patterns()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#armbr.run_armbr"><code class="docutils literal notranslate"><span class="pre">run_armbr()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>